{"version":3,"file":"Code-EX-2OHHV.js","sources":["../../../app/modules/core/components/base/notion/Code.tsx"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport CopyToClipboard from 'react-copy-to-clipboard';\nimport { SlArrowDown } from 'react-icons/sl';\nimport { Prism as SyntaxHighlighter } from 'react-syntax-highlighter';\nimport { coldarkDark } from 'react-syntax-highlighter/dist/cjs/styles/prism';\n\nimport type {\n  BlockComponentProps,\n  CodeBlock,\n  RichTextBlock,\n} from '~/libs/notion';\nimport { concatPlainTexts } from '~/libs/notion';\n\ninterface CodeProps extends BlockComponentProps {\n  block: CodeBlock;\n}\n\nconst shellLanguages = ['shell', 'bash'];\nconst expandableHeightThreshold = 400;\n\nexport function Code({ block }: CodeProps) {\n  const codeRef = useRef<HTMLDivElement>(null);\n  const [expanded, setExpanded] = useState(true);\n  const [copied, setCopied] = useState(false);\n\n  const { language, rich_text: richTexts } = block.code;\n  const codeText = concatPlainTexts(richTexts as RichTextBlock[]);\n\n  useEffect(() => {\n    if (\n      codeRef.current?.offsetHeight &&\n      codeRef.current.offsetHeight > expandableHeightThreshold\n    ) {\n      setExpanded(false);\n    }\n  }, [block]);\n\n  useEffect(() => {\n    let timeout;\n    if (copied) {\n      timeout = setTimeout(() => {\n        setCopied(!copied);\n      }, 3000);\n    } else {\n      clearTimeout(timeout);\n    }\n  }, [copied]);\n\n  return (\n    <div\n      className={`relative my-4 overflow-y-hidden transition ${\n        expanded ? 'h-fit' : 'h-96'\n      }`}\n      ref={codeRef}\n    >\n      <CopyToClipboard onCopy={() => setCopied(true)} text={codeText}>\n        <button className=\"absolute right-0 top-0 rounded-bl bg-slate-100 px-3 py-1 text-sm dark:bg-slate-800 dark:text-slate-400\">\n          {copied ? 'Copied' : 'Copy'}\n        </button>\n      </CopyToClipboard>\n\n      {!expanded && (\n        <>\n          <div className=\"absolute bottom-0 h-32 w-full bg-linear-to-b from-transparent to-white dark:to-slate-900\"></div>\n          <button\n            className=\"absolute bottom-0 left-1/2 flex -translate-x-1/2 items-center rounded-full bg-slate-800 px-6 py-1 text-sm text-slate-300 shadow-lg transition hover:bg-slate-700\"\n            onClick={() => setExpanded(true)}\n          >\n            Expand <SlArrowDown className=\"ml-2 h-3 w-3\" />\n          </button>\n        </>\n      )}\n\n      <SyntaxHighlighter\n        customStyle={{ margin: 0 }}\n        language={language}\n        showLineNumbers={!shellLanguages.includes(language)}\n        style={coldarkDark}\n      >\n        {codeText}\n      </SyntaxHighlighter>\n    </div>\n  );\n}\n"],"names":["SyntaxHighlighter"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAiBA,MAAM,iBAAiB,CAAC,SAAS,MAAM;AACvC,MAAM,4BAA4B;AAElB,SAAA,KAAK,EAAE,SAAoB;AACnC,QAAA,UAAU,OAAuB,IAAI;AAC3C,QAAM,CAAC,UAAU,WAAW,IAAI,SAAS,IAAI;AAC7C,QAAM,CAAC,QAAQ,SAAS,IAAI,SAAS,KAAK;AAE1C,QAAM,EAAE,UAAU,WAAW,cAAc,MAAM;AAC3C,QAAA,WAAW,iBAAiB,SAA4B;AAE9D,YAAU,MAAM;;AACd,UACE,aAAQ,YAAR,mBAAiB,iBACjB,QAAQ,QAAQ,eAAe,2BAC/B;AACA,kBAAY,KAAK;AAAA,IAAA;AAAA,EACnB,GACC,CAAC,KAAK,CAAC;AAEV,YAAU,MAAM;AACV,QAAA;AACJ,QAAI,QAAQ;AACV,gBAAU,WAAW,MAAM;AACzB,kBAAU,CAAC,MAAM;AAAA,SAChB,GAAI;AAAA,IAAA,OACF;AACL,mBAAa,OAAO;AAAA,IAAA;AAAA,EACtB,GACC,CAAC,MAAM,CAAC;AAGT,SAAA;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAW,8CACT,WAAW,UAAU,MACvB;AAAA,MACA,KAAK;AAAA,MAEL,UAAA;AAAA,QAAA,oBAAC,iBAAgB,EAAA,QAAQ,MAAM,UAAU,IAAI,GAAG,MAAM,UACpD,UAAA,oBAAC,YAAO,WAAU,0GACf,UAAS,SAAA,WAAW,OACvB,CAAA,GACF;AAAA,QAEC,CAAC,YAEE,qBAAA,UAAA,EAAA,UAAA;AAAA,UAAC,oBAAA,OAAA,EAAI,WAAU,2FAA2F,CAAA;AAAA,UAC1G;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,WAAU;AAAA,cACV,SAAS,MAAM,YAAY,IAAI;AAAA,cAChC,UAAA;AAAA,gBAAA;AAAA,gBACQ,oBAAC,aAAY,EAAA,WAAU,eAAe,CAAA;AAAA,cAAA;AAAA,YAAA;AAAA,UAAA;AAAA,QAC/C,GACF;AAAA,QAGF;AAAA,UAACA;AAAAA,UAAA;AAAA,YACC,aAAa,EAAE,QAAQ,EAAE;AAAA,YACzB;AAAA,YACA,iBAAiB,CAAC,eAAe,SAAS,QAAQ;AAAA,YAClD,OAAO;AAAA,YAEN,UAAA;AAAA,UAAA;AAAA,QAAA;AAAA,MACH;AAAA,IAAA;AAAA,EACF;AAEJ;"}